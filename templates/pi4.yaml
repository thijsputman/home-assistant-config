- sensor:
    - name: Pi4 memory available
      unique_id: 8a7ac8bf-cd0d-4ea9-95db-f8f276afd83f
      unit_of_measurement: MiB
      icon: mdi:memory
      availability: >-
        {{
          states('sensor.pi4_memavailreal_raw')
            not in ['unknown', 'unavailable'] and
          states('sensor.pi4_memcached_raw')
            not in ['unknown', 'unavailable'] and
          states('sensor.pi4_membuffer_raw')
            not in ['unknown', 'unavailable']
        }}
      state: >-
        {{
          ((
            (states('sensor.pi4_memavailreal_raw')|int) +
            (states('sensor.pi4_memcached_raw')|int) +
            (states('sensor.pi4_membuffer_raw')|int)
          ) | float/1000) | round(0)
        }}
    - name: Pi4 memory used (percentage)
      unique_id: 0888f6b5-7f3a-4f0b-9f87-df314e7e2c25
      unit_of_measurement: "%"
      icon: mdi:memory
      availability: >-
        {{
          states('sensor.pi4_memory_available')
            not in ['unknown', 'unavailable']
        }}
      state: >-
        {{
          (
            (1 - (states('sensor.pi4_memory_available')|float) / 4096) * 100
          ) | round(2)
        }}
    - name: Pi4 Sandbox memory available
      unique_id: ef841e6c-f24f-4fd6-9aae-3ba671730df3
      unit_of_measurement: MiB
      icon: mdi:memory
      availability: >-
        {{
          states('sensor.pi4_sandbox_memavailreal_raw')
            not in ['unknown', 'unavailable'] and
          states('sensor.pi4_sandbox_memcached_raw')
            not in ['unknown', 'unavailable'] and
          states('sensor.pi4_sandbox_membuffer_raw')
            not in ['unknown', 'unavailable']
        }}
      state: >-
        {{
          ((
            (states('sensor.pi4_sandbox_memavailreal_raw')|int) +
            (states('sensor.pi4_sandbox_memcached_raw')|int) +
            (states('sensor.pi4_sandbox_membuffer_raw')|int)
          ) | float/1000) | round(0)
        }}
    - name: Pi4 Sandbox memory used (percentage)
      unique_id: 377585c3-df9a-443e-a5cd-c75bfb79b8a1
      unit_of_measurement: "%"
      icon: mdi:memory
      availability: >-
        {{
          states('sensor.pi4_sandbox_memory_available')
            not in ['unknown', 'unavailable']
        }}
      state: >-
        {{
          (
            (1 - (states('sensor.pi4_sandbox_memory_available')|float)
              / 2048) * 100
          ) | round(2)
        }}
